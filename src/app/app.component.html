<!-- Loading State -->
<ng-container *ngIf="bibleService.isLoading && !bibleService.errorMessage">
    <div class="flex justify-center items-center h-screen bg-light-bg-primary dark:bg-dark-bg-primary">
        <div class="text-center">
            <div class="spinner w-12 h-12 border-4 text-primary-600 dark:text-primary-400 mx-auto"></div>
            <p class="mt-4 text-light-text-secondary dark:text-dark-text-secondary">ஏற்றுகிறது...</p>
        </div>
    </div>
</ng-container>

<!-- Error State -->
<ng-container *ngIf="bibleService.errorMessage && !bibleService.isLoading">
    <div class="flex justify-center items-center h-screen bg-light-bg-primary dark:bg-dark-bg-primary">
        <div class="max-w-md mx-auto space-y-4 px-5 text-center">
            <h2 class="text-light-text-primary dark:text-dark-text-primary text-lg font-medium">{{ bibleService.errorMessage }}</h2>
            <button type="button" class="btn-primary" (click)="bibleService.init()">மீண்டும் முயற்சிக்கவும்</button>
        </div>
    </div>
</ng-container>

<!-- Main Content -->
<ng-container *ngIf="bibleService.getBooks().length > 0 && bibleService.bible.length > 0 && !bibleService.isLoading && !bibleService.errorMessage">
    <div class="app-container">
        <!-- Sidebar -->
        <app-sidebar [books]="books" [chapters]="chapters" [selectedBook]="currentBook" [selectedChapter]="currentChapter" [isOpen]="isSidebarOpen" (bookChange)="onSidebarBookChange($event)" (chapterChange)="onSidebarChapterChange($event)" (toggleSidebar)="onToggleSidebar()"></app-sidebar>

        <!-- Sidebar Overlay (Mobile) -->
        <div class="sidebar-overlay" *ngIf="isSidebarOpen" (click)="onToggleSidebar()"></div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Top Header -->
            <header class="top-header">
                <div class="header-left">
                    <button type="button" class="menu-btn" *ngIf="!isSidebarOpen" (click)="onToggleSidebar()" aria-label="Open sidebar">
                        <!-- Hamburger icon when sidebar is closed -->
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                    <div class="current-selection">
                        <h1 class="book-title">{{ currentBook?.name || "Bible" }}</h1>
                        <span class="chapter-info" *ngIf="currentChapter">அத்தியாயம் {{ currentChapter.id }}</span>
                    </div>
                </div>
                <div class="header-right">
                    <app-theme-toggle></app-theme-toggle>
                    <!-- Font size control - Desktop only -->
                    <div class="desktop-font-control">
                        <app-font-size-control [fontSize]="fontSize" (fontSizeChange)="onFontSizeChange($event)"></app-font-size-control>
                    </div>
                </div>
            </header>

            <!-- Reading Area -->
            <div class="reading-area">
                <app-reading [verses]="bibleService.currentVerses" [fontSize]="fontSize"></app-reading>
            </div>

            <!-- Bottom Navigation (Mobile) -->
            <div class="bottom-nav">
                <app-chapter-navigation [canGoPrevious]="bibleService.canGoPrevious()" [canGoNext]="bibleService.canGoNext()" (navigate)="onNavigate($event)"></app-chapter-navigation>
                <!-- Font size control - Mobile only -->
                <div class="mobile-font-control">
                    <app-font-size-control [fontSize]="fontSize" (fontSizeChange)="onFontSizeChange($event)"></app-font-size-control>
                </div>
            </div>
        </main>
    </div>
</ng-container>
